<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>spacepy.onerapy.onerapy</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="spacepy-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://spacepy.lanl.gov">SpacePy: Space Science Tools for Python</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="spacepy-module.html">Package&nbsp;spacepy</a> ::
        <a href="spacepy.onerapy-module.html">Package&nbsp;onerapy</a> ::
        Module&nbsp;onerapy
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="spacepy.onerapy.onerapy-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module onerapy</h1><p class="nomargin-top"><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html">source&nbsp;code</a></span></p>
<p>module wrapper for onera_desp_lib Reference: D. Boscher1, S. 
  Bourdarie1, P. O'Brien2, T. Guild2,(1 ONERA-DESP, Toulouse France; 2 
  Aerospace Corporation, Washington DC, USA), ONERA-DESP library V4.2, 
  Toulouse-France, 2004-2008</p>

<hr />
<div class="fields">      <p><strong>Version:</strong>
        $Revision: 1.14 $, $Date: 2011/01/06 00:55:07 $
      </p>
      <p><strong>Author:</strong>
        Josef Koller, Los Alamos National Lab (jkoller@lanl.gov)
      </p>
</div><!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#get_Bfield" class="summary-sig-name">get_Bfield</a>(<span class="summary-sig-arg">ticktock</span>,
        <span class="summary-sig-arg">Coords</span>,
        <span class="summary-sig-arg">extMag</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">options</span>=<span class="summary-sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">omnivals</span>=<span class="summary-sig-default">None</span>)</span><br />
      call get_bfield in onera_desp lib and return a dictionary with the 
      B-field vector and strenght.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#get_Bfield">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#find_Bmirror" class="summary-sig-name">find_Bmirror</a>(<span class="summary-sig-arg">ticktock</span>,
        <span class="summary-sig-arg">Coords</span>,
        <span class="summary-sig-arg">alpha</span>,
        <span class="summary-sig-arg">extMag</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">options</span>=<span class="summary-sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">omnivals</span>=<span class="summary-sig-default">None</span>)</span><br />
      call find_mirror_point from onera_desp library and return a 
      dictionary with values for Blocal, Bmirr and the GEO (cartesian) 
      coordinates of the mirror point</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#find_Bmirror">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#find_magequator" class="summary-sig-name">find_magequator</a>(<span class="summary-sig-arg">ticktock</span>,
        <span class="summary-sig-arg">Coords</span>,
        <span class="summary-sig-arg">extMag</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">options</span>=<span class="summary-sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">omnivals</span>=<span class="summary-sig-default">None</span>)</span><br />
      call find_magequator from onera_desp library and return a dictionary 
      with values for Bmin and the GEO (cartesian) coordinates of the 
      magnetic equator</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#find_magequator">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#coord_trans" class="summary-sig-name">coord_trans</a>(<span class="summary-sig-arg">Coords</span>,
        <span class="summary-sig-arg">returntype</span>,
        <span class="summary-sig-arg">returncarsph</span>)</span><br />
      thin layer to call coor_trans1 from onera_desp lib this will convert 
      between systems GDZ, GEO, GSM, GSE, SM, GEI, MAG, SPH, RLL</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#coord_trans">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#car2sph" class="summary-sig-name">car2sph</a>(<span class="summary-sig-arg">CARin</span>)</span><br />
      coordinate transformation from cartesian to spherical</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#car2sph">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#sph2car" class="summary-sig-name">sph2car</a>(<span class="summary-sig-arg">SPHin</span>)</span><br />
      coordinate transformation from spherical to cartesian</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#sph2car">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#get_sysaxes" class="summary-sig-name">get_sysaxes</a>(<span class="summary-sig-arg">dtype</span>,
        <span class="summary-sig-arg">carsph</span>)</span><br />
      will return the sysaxes according to the onera_desp library</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#get_sysaxes">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#get_dtype" class="summary-sig-name">get_dtype</a>(<span class="summary-sig-arg">sysaxes</span>)</span><br />
      will return the coordinate system type as string</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#get_dtype">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#_get_Lstar" class="summary-sig-name" onclick="show_private();">_get_Lstar</a>(<span class="summary-sig-arg">ticktock</span>,
        <span class="summary-sig-arg">coords</span>,
        <span class="summary-sig-arg">alpha</span>=<span class="summary-sig-default"><code class="variable-group">[</code><code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">extMag</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">options</span>=<span class="summary-sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">omnivals</span>=<span class="summary-sig-default">None</span>)</span><br />
      This will call make_lstar1 or make_lstar_shell_splitting_1 from the 
      onera library and will lookup omni values for given time if not 
      provided (optional).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#_get_Lstar">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.onerapy.onerapy-module.html#get_Lstar" class="summary-sig-name">get_Lstar</a>(<span class="summary-sig-arg">ticktock</span>,
        <span class="summary-sig-arg">coords</span>,
        <span class="summary-sig-arg">alpha</span>,
        <span class="summary-sig-arg">extMag</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">options</span>=<span class="summary-sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">omnivals</span>=<span class="summary-sig-default">None</span>)</span><br />
      This will call make_lstar1 or make_lstar_shell_splitting_1 from the 
      onera library and will lookup omni values for given time if not 
      provided (optional).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#get_Lstar">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="prep_onera"></a><span class="summary-sig-name">prep_onera</span>(<span class="summary-sig-arg">ticktock</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">coords</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">alpha</span>=<span class="summary-sig-default"><code class="variable-group">[</code><code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">extMag</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">options</span>=<span class="summary-sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">omnivals</span>=<span class="summary-sig-default">None</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#prep_onera">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="spacepy.onerapy.onerapy-module.html#SYSAXES_TYPES" class="summary-name">SYSAXES_TYPES</a> = <code title="{'GDZ': {'car': None, 'sph': 0},
 'GEI': {'car': 5, 'sph': None},
 'GEO': {'car': 1, 'sph': None},
 'GSE': {'car': 3, 'sph': None},
 'GSM': {'car': 2, 'sph': None},
 'MAG': {'car': 6, 'sph': None},
 'RLL': {'car': None, 'sph': 8},
 'SM': {'car': 4, 'sph': None},
..."><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">GDZ</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-op">: </code>None<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sph</code><code class="variable-quote">'</code><code class="variable-op">: </code>0<code class="variable-group">}</code><code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">GEI</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'spacepy.onerapy'"><code class="variable-quote">'</code><code class="variable-string">spacepy.onerapy</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="get_Bfield"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_Bfield</span>(<span class="sig-arg">ticktock</span>,
        <span class="sig-arg">Coords</span>,
        <span class="sig-arg">extMag</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">options</span>=<span class="sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="sig-arg">omnivals</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#get_Bfield">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>call get_bfield in onera_desp lib and return a dictionary with the 
  B-field vector and strenght.</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        ticktock (Ticktock class) : containing time information
      </li>
      <li>
        Coords (Coords class) : containing spatial information
      </li>
      <li>
        extMag (string) : optional; will choose the external magnetic field
        model possible values ['0', 'MEAD', 'T87SHORT', 'T87LONG', 'T89', 
        'OPQUIET', 'OPDYN', 'T96', 'OSTA', 'T01QUIET', 'T01STORM', 'T05', 
        'ALEX']
      </li>
      <li>
        options (optional list or array of integers length=5) : explained 
        in Lstar
      </li>
      <li>
        omni values as dictionary (optional) : if not provided, will use 
        lookup table
      </li>
      <li>
        (see Lstar documentation for further explanation)
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        results (dictionary) : containing keys: Bvec, and Blocal
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>t = Ticktock([<span class="py-string">'2002-02-02T12:00:00'</span>, <span class="py-string">'2002-02-02T12:10:00'</span>], <span class="py-string">'ISO'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>y = Coords([[3,0,0],[2,0,0]], <span class="py-string">'GEO'</span>, <span class="py-string">'car'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>op.get_Bfield(t,y)
<span class="py-output">{'Blocal': array([  945.99989101,  3381.71633205]),</span>
<span class="py-output">        'Bvec': array([[  8.05001055e-01,  -1.54645026e+02,   9.33273841e+02],</span>
<span class="py-output">        [  3.36352963e+02,  -5.33658140e+02,   3.32236076e+03]])}</span></pre>
  <h1 class="heading">See Also:</h1>
    <p>Lstar, find_Bmirror, find_magequator</p>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 05-Mar-2010 (JK)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="find_Bmirror"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_Bmirror</span>(<span class="sig-arg">ticktock</span>,
        <span class="sig-arg">Coords</span>,
        <span class="sig-arg">alpha</span>,
        <span class="sig-arg">extMag</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">options</span>=<span class="sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="sig-arg">omnivals</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#find_Bmirror">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>call find_mirror_point from onera_desp library and return a dictionary
  with values for Blocal, Bmirr and the GEO (cartesian) coordinates of the 
  mirror point</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        ticktock (Ticktock class) : containing time information
      </li>
      <li>
        Coords (Coords class) : containing spatial information
      </li>
      <li>
        alpha (list or ndarray) : containing the pitch angles
      </li>
      <li>
        extMag (string) : optional; will choose the external magnetic field
        model possible values ['0', 'MEAD', 'T87SHORT', 'T87LONG', 'T89', 
        'OPQUIET', 'OPDYN', 'T96', 'OSTA', 'T01QUIET', 'T01STORM', 'T05', 
        'ALEX']
      </li>
      <li>
        options (optional list or array of integers length=5) : explained 
        in Lstar
      </li>
      <li>
        omni values as dictionary (optional) : if not provided, will use 
        lookup table
      </li>
      <li>
        (see Lstar documentation for further explanation)
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        results (dictionary) : containing keys: Blocal, Bmirr, GEOcar
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>t = Ticktock([<span class="py-string">'2002-02-02T12:00:00'</span>, <span class="py-string">'2002-02-02T12:10:00'</span>], <span class="py-string">'ISO'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>y = Coords([[3,0,0],[2,0,0]], <span class="py-string">'GEO'</span>, <span class="py-string">'car'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>op.find_Bmirror(t,y,[90,80,60,10])
<span class="py-output">{'Blocal': array([ 0.,  0.]),</span>
<span class="py-output"> 'Bmirr': array([ 0.,  0.]),</span>
<span class="py-output"> 'GEOcar': Coords( [[ NaN  NaN  NaN]</span>
<span class="py-output"> [ NaN  NaN  NaN]] ), dtype=GEO,car, units=['Re', 'Re', 'Re']}</span></pre>
  <h1 class="heading">See Also:</h1>
    <p>Lstar, get_Bfield, find_magequator</p>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 05-Mar-2010 (JK)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="find_magequator"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_magequator</span>(<span class="sig-arg">ticktock</span>,
        <span class="sig-arg">Coords</span>,
        <span class="sig-arg">extMag</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">options</span>=<span class="sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="sig-arg">omnivals</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#find_magequator">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>call find_magequator from onera_desp library and return a dictionary 
  with values for Bmin and the GEO (cartesian) coordinates of the magnetic 
  equator</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        ticktock (Ticktock class) : containing time information
      </li>
      <li>
        Coords (Coords class) : containing spatial information
      </li>
      <li>
        extMag (string) : optional; will choose the external magnetic field
        model possible values ['0', 'MEAD', 'T87SHORT', 'T87LONG', 'T89', 
        'OPQUIET', 'OPDYN', 'T96', 'OSTA', 'T01QUIET', 'T01STORM', 'T05', 
        'ALEX']
      </li>
      <li>
        options (optional list or array of integers length=5) : explained 
        in Lstar
      </li>
      <li>
        omni values as dictionary (optional) : if not provided, will use 
        lookup table
      </li>
      <li>
        (see Lstar documentation for further explanation)
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        results (dictionary) : containing keys: Bmin, Coords instance with 
        GEO coordinates of the magnetic equator
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>t = Ticktock([<span class="py-string">'2002-02-02T12:00:00'</span>, <span class="py-string">'2002-02-02T12:10:00'</span>], <span class="py-string">'ISO'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>y = Coords([[3,0,0],[2,0,0]], <span class="py-string">'GEO'</span>, <span class="py-string">'car'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>op.find_magequator(t,y)
<span class="py-output">{'Bmin': array([  945.63652413,  3373.64496167]),</span>
<span class="py-output"> 'GEOcar': Coords( [[ 2.99938371  0.00534151 -0.03213603]</span>
<span class="py-output"> [ 2.00298822 -0.0073077   0.04584859]] ), dtype=GEO,car, units=['Re', 'Re', 'Re']}</span></pre>
  <h1 class="heading">See Also:</h1>
    <p>Lstar, get_Bfield, find_Bmirr</p>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 05-Mar-2010 (JK)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="coord_trans"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">coord_trans</span>(<span class="sig-arg">Coords</span>,
        <span class="sig-arg">returntype</span>,
        <span class="sig-arg">returncarsph</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#coord_trans">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>thin layer to call coor_trans1 from onera_desp lib this will convert 
  between systems GDZ, GEO, GSM, GSE, SM, GEI, MAG, SPH, RLL</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        Coords (Coords instance) : containing coordinate information, can 
        contain n points
      </li>
      <li>
        returntype (str) : describing system as GDZ, GEO, GSM, GSE, SM, 
        GEI, MAG, SPH, RLL
      </li>
      <li>
        returncarsph (str) : cartesian or spherical units 'car', 'sph'
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        xout (ndarray) : values after transformation in (n,3) dimensions
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>coord = Coords([[3,0,0],[2,0,0]], <span class="py-string">'GEO'</span>, <span class="py-string">'car'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>coord.ticktock = Ticktock([<span class="py-string">'2002-02-02T12:00:00'</span>, <span class="py-string">'2002-02-02T12:10:00'</span>], <span class="py-string">'ISO'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>coord_trans(coord, <span class="py-string">'GSM'</span>, <span class="py-string">'car'</span>)
<span class="py-output">array([[ 2.8639301 , -0.01848784,  0.89306361],</span>
<span class="py-output">[ 1.9124434 ,  0.07209424,  0.58082929]])</span></pre>
  <h1 class="heading">See Also:</h1>
    <p>sph2car, car2sph</p>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 05-Mar-2010 (JK)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="car2sph"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">car2sph</span>(<span class="sig-arg">CARin</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#car2sph">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>coordinate transformation from cartesian to spherical</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        CARin (list or ndarray) : coordinate points in (n,3) shape with n 
        coordinate points in units of [Re, Re, Re] = [x,y,z]
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        results (ndarray) : values after conversion to spherical 
        coordinates in radius, latitude, longitude in units of [Re, deg, 
        deg]
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>sph2car([1,45,0])
<span class="py-output">array([ 0.70710678,  0.        ,  0.70710678])</span></pre>
  <h1 class="heading">See Also:</h1>
    <p>sph2car</p>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 05-Mar-2010 (JK)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="sph2car"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">sph2car</span>(<span class="sig-arg">SPHin</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#sph2car">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>coordinate transformation from spherical to cartesian</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        SPHin (list or ndarray) : coordinate points in (n,3) shape with n 
        coordinate points in units of [Re, deg, deg] = [r, latitude, 
        longitude]
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        results (ndarray) : values after conversion to cartesian 
        coordinates x,y,z
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>sph2car([1,45,45])
<span class="py-output">array([ 0.5       ,  0.5       ,  0.70710678])</span></pre>
  <h1 class="heading">See Also:</h1>
    <p>car2sph</p>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 05-Mar-2010 (JK)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_sysaxes"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_sysaxes</span>(<span class="sig-arg">dtype</span>,
        <span class="sig-arg">carsph</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#get_sysaxes">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>will return the sysaxes according to the onera_desp library</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        dtype (str) : coordinate system, possible values: GDZ, GEO, GSM, 
        GSE, SM, GEI, MAG, SPH, RLL
      </li>
      <li>
        carsph (str) : cartesian or spherical, possible values: 'sph', 
        'car'
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        sysaxes (int) : value after oner_desp library from 0-8 (or None if 
        not available)
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>get_sysaxes(<span class="py-string">'GSM'</span>, <span class="py-string">'car'</span>)
<span class="py-output">2</span></pre>
  <h1 class="heading">See Also:</h1>
    <p>get_dtype</p>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov Steve 
    Morley, Los Alamos National Lab, smorley@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 05-Mar-2010 (JK) V2: 10-May-2010 (SM)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_dtype"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_dtype</span>(<span class="sig-arg">sysaxes</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#get_dtype">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>will return the coordinate system type as string</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        sysaxes (int) : number according to the onera_desp_lib, possible 
        values: 0-8
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        dtype (str) : coordinate system GDZ, GEO, GSM, GSE, SM, GEI, MAG, 
        SPH, RLL
      </li>
      <li>
        carsph (str) : cartesian or spherical 'car', 'sph'
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>get_dtype(3)
<span class="py-output">('GSE', 'car')</span></pre>
  <h1 class="heading">See Also:</h1>
    <p>get_sysaxes</p>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 05-Mar-2010 (JK)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_get_Lstar"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_get_Lstar</span>(<span class="sig-arg">ticktock</span>,
        <span class="sig-arg">coords</span>,
        <span class="sig-arg">alpha</span>=<span class="sig-default"><code class="variable-group">[</code><code class="variable-group">]</code></span>,
        <span class="sig-arg">extMag</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">options</span>=<span class="sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="sig-arg">omnivals</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#_get_Lstar">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>This will call make_lstar1 or make_lstar_shell_splitting_1 from the 
  onera library and will lookup omni values for given time if not provided 
  (optional). If pitch angles are provided, drift shell splitting will be 
  calculated and &quot;Bmirr&quot; will be returned. If they are not 
  provided, then no drift shell splitting is calculated and 
  &quot;Blocal&quot; is returned.</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        ticktock (Ticktock class) : containing time information
      </li>
      <li>
        Coords (Coords class) : containing spatial information
      </li>
      <li>
        alpha (list or ndarray) : optional pitch angles in degrees; if 
        provided will calculate shell splitting; max 25 values
      </li>
      <li>
        extMag (string) : optional; will choose the external magnetic field
        model possible values ['0', 'MEAD', 'T87SHORT', 'T87LONG', 'T89', 
        'OPQUIET', 'OPDYN', 'T96', 'OSTA', 'T01QUIET', 'T01STORM', 'T05', 
        'ALEX']
      </li>
      <li>
        options (optional list or array of integers length=5) : explained 
        below
      </li>
      <li>
        omni values as dictionary (optional) : if not provided, will use 
        lookup table
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        results (dictionary) : containing keys: Lm, Lstar, Bmin, Blocal (or
        Bmirr), Xj, MLT if pitch angles provided in &quot;alpha&quot; then 
        drift shells are calculated and &quot;Bmirr&quot; is returned if 
        not provided, then &quot;Blocal&quot; at spacecraft is returned.
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>t = Ticktock([<span class="py-string">'2002-02-02T12:00:00'</span>, <span class="py-string">'2002-02-02T12:10:00'</span>], <span class="py-string">'ISO'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>y = Coords([[3,0,0],[2,0,0]], <span class="py-string">'GEO'</span>, <span class="py-string">'car'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>spacepy.onerapy.Lstar(t,y)
<span class="py-output">{'Blocal': array([ 1020.40493286,  3446.08845227]),</span>
<span class="py-output"> 'Bmin': array([ 1019.98404311,  3437.63865243]),</span>
<span class="py-output"> 'Lm': array([ 3.08948304,  2.06022102]),</span>
<span class="py-output"> 'Lstar': array([ 2.97684043,  1.97868577]),</span>
<span class="py-output"> 'MLT': array([ 23.5728333 ,  23.57287944]),</span>
<span class="py-output"> 'Xj': array([ 0.00112884,  0.00286955])}</span></pre>
  <h1 class="heading">External Magnetic Field:</h1>
    <ul>
      <li>
        0        : no external field
      </li>
      <li>
        MEAD  : Mead &amp; Fairfield [1975] (uses 0&lt;=Kp&lt;=9 - Valid 
        for rGEO&lt;=17. Re)
      </li>
      <li>
        T87SHORT: Tsyganenko short [1987] (uses 0&lt;=Kp&lt;=9 - Valid for 
        rGEO&lt;=30. Re)
      </li>
      <li>
        T87LONG : Tsyganenko long [1987] (uses 0&lt;=Kp&lt;=9 - Valid for 
        rGEO&lt;=70. Re)
      </li>
      <li>
        T89    : Tsyganenko [1989] (uses 0&lt;=Kp&lt;=9 - Valid for 
        rGEO&lt;=70. Re)
      </li>
      <li>
        OPQUIET : Olson &amp; Pfitzer quiet [1977] (default - Valid for 
        rGEO&lt;=15. Re)
      </li>
      <li>
        OPDYN   : Olson &amp; Pfitzer dynamic [1988] (uses 
        5.&lt;=dens&lt;=50., 300.&lt;=velo&lt;=500., -100.&lt;=Dst&lt;=20. 
        - Valid for rGEO&lt;=60. Re)
      </li>
      <li>
        T96    : Tsyganenko [1996] (uses -100.&lt;=Dst (nT)&lt;=20., 
        0.5&lt;=Pdyn (nPa)&lt;10., |ByIMF| (nT)&lt;1=0., |BzIMF| 
        (nT)&lt;=10. - Valid for rGEO&lt;=40. Re)
      </li>
      <li>
        OSTA  : Ostapenko &amp; Maltsev [1997] (uses dst,Pdyn,BzIMF, Kp) 
        T01QUIET: Tsyganenko [2002a,b] (uses -50.&lt;Dst (nT)&lt;20., 
        0.5&lt;Pdyn (nPa)&lt;=5., |ByIMF| (nT)&lt;=5., |BzIMF| (nT)&lt;=5.,
        0.&lt;=G1&lt;=10., 0.&lt;=G2&lt;=10. - Valid for xGSM&gt;=-15. Re)
      </li>
      <li>
        T01STORM: Tsyganenko, Singer &amp; Kasper [2003] storm  (uses Dst, 
        Pdyn, ByIMF, BzIMF, G2, G3 - there is no upper or lower limit for 
        those inputs - Valid for xGSM&gt;=-15. Re)
      </li>
      <li>
        T05    : Tsyganenko &amp; Sitnov [2005] storm  (uses Dst, Pdyn, 
        ByIMF, BzIMF, W1, W2, W3, W4, W5, W6 - no upper or lower limit for 
        inputs - Valid for xGSM&gt;=-15. Re)
      </li>
    </ul>
  <h1 class="heading">OMNI Values:</h1>
    <ul>
      <li>
        Kp: value of Kp as in OMNI2 files but has to be double instead of 
        integer type
      </li>
      <li>
        Dst: Dst index (nT)
      </li>
      <li>
        dens: Solar Wind density (cm-3)
      </li>
      <li>
        velo: Solar Wind velocity (km/s)
      </li>
      <li>
        Pdyn: Solar Wind dynamic pressure (nPa)
      </li>
      <li>
        ByIMF: GSM y component of IMF mag. field (nT)
      </li>
      <li>
        BzIMF: GSM z component of IMF mag. field (nT)
      </li>
      <li>
        G1:  G1=&lt; Vsw*(Bperp/40)2/(1+Bperp/40)*sin3(theta/2) &gt; where 
        the &lt;&gt; mean an average over the previous 1 hour, Vsw is the 
        solar wind speed, Bperp is the transverse IMF component (GSM) and 
        theta it's clock angle.
      </li>
      <li>
        G2: G2=&lt; a*Vsw*Bs &gt; where the &lt;&gt; mean an average over 
        the previous 1 hour, Vsw is solar wind speed, Bs=|IMF Bz| when IMF 
        Bz &lt; 0 and Bs=0 when IMF Bz &gt; 0, a=0.005.
      </li>
      <li>
        G3:  G3=&lt; Vsw*Dsw*Bs /2000.&gt; where the &lt;&gt; mean an 
        average over the previous 1 hour, Vsw is the solar wind speed, Dsw 
        is the solar wind density, Bs=|IMF Bz| when IMF Bz &lt; 0 and Bs=0 
        when IMF Bz &gt; 0.
      </li>
      <li>
        W1 - W6: see definition in (JGR-A, v.110(A3), 2005.) (PDF 1.2MB)
      </li>
      <li>
        AL: the auroral index
      </li>
    </ul>
  <h1 class="heading">Options:</h1>
    <ul>
      <li>
        1st element: 0 - don't compute L* or phi ;  1 - compute L*; 2- 
        compute phi
      </li>
      <li>
        2nd element: 0 - initialize IGRF field once per year (year.5); n - 
        n is the  frequency (in days) starting on January 1st of each year 
        (i.e. if options(2nd element)=15 then IGRF will be updated on the 
        following days of the year: 1, 15, 30, 45 ...)
      </li>
      <li>
        3rd element: resolution to compute L* (0 to 9) where 0 is the 
        recomended value to ensure a good ratio precision/computation time 
        (i.e. an error of ~2% at L=6). The higher the value the better will
        be the precision, the longer will be the computing time. Generally 
        there is not much improvement for values larger than 4. Note that 
        this parameter defines the integration step (theta) along the field
        line such as dtheta=(2pi)/(720*[options(3rd element)+1])
      </li>
      <li>
        4th element: resolution to compute L* (0 to 9). The higher the 
        value the better will be the precision, the longer will be the 
        computing time. It is recommended to use 0 (usually sufficient) 
        unless L* is not computed on a LEO orbit. For LEO orbit higher 
        values are recommended. Note that this parameter defines the 
        integration step (phi) along the drift shell such as 
        dphi=(2pi)/(25*[options(4th element)+1])
      </li>
      <li>
        5th element: allows to select an internal magnetic field model 
        (default is set to IGRF)
        <ul>
          <li>
            0 = IGRF
          </li>
          <li>
            1 = Eccentric tilted dipole
          </li>
          <li>
            2 = Jensen&amp;Cain 1960
          </li>
          <li>
            3 = GSFC 12/66 updated to 1970
          </li>
        </ul>
      </li>
    </ul>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 03-Feb-2010 (JK) V1.1: 22-Feb-2010: fixed Blocal and Bmirr bug 
    (JK) V1.2: 05-Mar-2010: ticktock, Coords support (JK)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_Lstar"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_Lstar</span>(<span class="sig-arg">ticktock</span>,
        <span class="sig-arg">coords</span>,
        <span class="sig-arg">alpha</span>,
        <span class="sig-arg">extMag</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">T01STORM</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">options</span>=<span class="sig-default"><code class="variable-group">[</code>1<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-op">, </code>0<code class="variable-group">]</code></span>,
        <span class="sig-arg">omnivals</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.onerapy.onerapy-pysrc.html#get_Lstar">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>This will call make_lstar1 or make_lstar_shell_splitting_1 from the 
  onera library and will lookup omni values for given time if not provided 
  (optional). If pitch angles are provided, drift shell splitting will be 
  calculated and &quot;Bmirr&quot; will be returned. If they are not 
  provided, then no drift shell splitting is calculated and 
  &quot;Blocal&quot; is returned.</p>
  <h1 class="heading">Input:</h1>
    <ul>
      <li>
        ticktock (Ticktock class) : containing time information
      </li>
      <li>
        coords (Coords class) : containing spatial information
      </li>
      <li>
        alpha (list or ndarray) : optional pitch angles in degrees; if 
        provided will calculate shell splitting; max 25 values
      </li>
      <li>
        extMag (string) : optional; will choose the external magnetic field
        model possible values ['0', 'MEAD', 'T87SHORT', 'T87LONG', 'T89', 
        'OPQUIET', 'OPDYN', 'T96', 'OSTA', 'T01QUIET', 'T01STORM', 'T05', 
        'ALEX']
      </li>
      <li>
        options (optional list or array of integers length=5) : explained 
        below
      </li>
      <li>
        omni values as dictionary (optional) : if not provided, will use 
        lookup table
      </li>
    </ul>
  <h1 class="heading">Returns:</h1>
    <ul>
      <li>
        results (dictionary) : containing keys: Lm, Lstar, Bmin, Blocal (or
        Bmirr), Xj, MLT if pitch angles provided in &quot;alpha&quot; then 
        drift shells are calculated and &quot;Bmirr&quot; is returned if 
        not provided, then &quot;Blocal&quot; at spacecraft is returned.
      </li>
    </ul>
  <h1 class="heading">Example:</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>t = Ticktock([<span class="py-string">'2002-02-02T12:00:00'</span>, <span class="py-string">'2002-02-02T12:10:00'</span>], <span class="py-string">'ISO'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>y = Coords([[3,0,0],[2,0,0]], <span class="py-string">'GEO'</span>, <span class="py-string">'car'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>spacepy.onerapy.Lstar(t,y)
<span class="py-output">{'Blocal': array([ 1020.40493286,  3446.08845227]),</span>
<span class="py-output">    'Bmin': array([ 1019.98404311,  3437.63865243]),</span>
<span class="py-output">    'Lm': array([ 3.08948304,  2.06022102]),</span>
<span class="py-output">    'Lstar': array([ 2.97684043,  1.97868577]),</span>
<span class="py-output">    'MLT': array([ 23.5728333 ,  23.57287944]),</span>
<span class="py-output">    'Xj': array([ 0.00112884,  0.00286955])}</span></pre>
  <h1 class="heading">External Magnetic Field:</h1>
    <ul>
      <li>
        0    : no external field
      </li>
      <li>
        MEAD  : Mead &amp; Fairfield [1975] (uses 0&lt;=Kp&lt;=9 - Valid 
        for rGEO&lt;=17. Re)
      </li>
      <li>
        T87SHORT: Tsyganenko short [1987] (uses 0&lt;=Kp&lt;=9 - Valid for 
        rGEO&lt;=30. Re)
      </li>
      <li>
        T87LONG : Tsyganenko long [1987] (uses 0&lt;=Kp&lt;=9 - Valid for 
        rGEO&lt;=70. Re)
      </li>
      <li>
        T89    : Tsyganenko [1989] (uses 0&lt;=Kp&lt;=9 - Valid for 
        rGEO&lt;=70. Re)
      </li>
      <li>
        OPQUIET : Olson &amp; Pfitzer quiet [1977] (default - Valid for 
        rGEO&lt;=15. Re)
      </li>
      <li>
        OPDYN   : Olson &amp; Pfitzer dynamic [1988] (uses 
        5.&lt;=dens&lt;=50., 300.&lt;=velo&lt;=500., -100.&lt;=Dst&lt;=20. 
        - Valid for rGEO&lt;=60. Re)
      </li>
      <li>
        T96    : Tsyganenko [1996] (uses -100.&lt;=Dst (nT)&lt;=20., 
        0.5&lt;=Pdyn (nPa)&lt;10., |ByIMF| (nT)&lt;1=0., |BzIMF| 
        (nT)&lt;=10. - Valid for rGEO&lt;=40. Re)
      </li>
      <li>
        OSTA  : Ostapenko &amp; Maltsev [1997] (uses dst,Pdyn,BzIMF, Kp) 
        T01QUIET: Tsyganenko [2002a,b] (uses -50.&lt;Dst (nT)&lt;20., 
        0.5&lt;Pdyn (nPa)&lt;=5., |ByIMF| (nT)&lt;=5., |BzIMF| (nT)&lt;=5.,
        0.&lt;=G1&lt;=10., 0.&lt;=G2&lt;=10. - Valid for xGSM&gt;=-15. Re)
      </li>
      <li>
        T01STORM: Tsyganenko, Singer &amp; Kasper [2003] storm  (uses Dst, 
        Pdyn, ByIMF, BzIMF, G2, G3 - there is no upper or lower limit for 
        those inputs - Valid for xGSM&gt;=-15. Re)
      </li>
      <li>
        T05    : Tsyganenko &amp; Sitnov [2005] storm  (uses Dst, Pdyn, 
        ByIMF, BzIMF, W1, W2, W3, W4, W5, W6 - no upper or lower limit for 
        inputs - Valid for xGSM&gt;=-15. Re)
      </li>
    </ul>
  <h1 class="heading">OMNI Values:</h1>
    <ul>
      <li>
        Kp: value of Kp as in OMNI2 files but has to be double instead of 
        integer type
      </li>
      <li>
        Dst: Dst index (nT)
      </li>
      <li>
        dens: Solar Wind density (cm-3)
      </li>
      <li>
        velo: Solar Wind velocity (km/s)
      </li>
      <li>
        Pdyn: Solar Wind dynamic pressure (nPa)
      </li>
      <li>
        ByIMF: GSM y component of IMF mag. field (nT)
      </li>
      <li>
        BzIMF: GSM z component of IMF mag. field (nT)
      </li>
      <li>
        G1:  G1=&lt; Vsw*(Bperp/40)2/(1+Bperp/40)*sin3(theta/2) &gt; where 
        the &lt;&gt; mean an average over the previous 1 hour, Vsw is the 
        solar wind speed, Bperp is the transverse IMF component (GSM) and 
        theta it's clock angle.
      </li>
      <li>
        G2: G2=&lt; a*Vsw*Bs &gt; where the &lt;&gt; mean an average over 
        the previous 1 hour, Vsw is solar wind speed, Bs=|IMF Bz| when IMF 
        Bz &lt; 0 and Bs=0 when IMF Bz &gt; 0, a=0.005.
      </li>
      <li>
        G3:  G3=&lt; Vsw*Dsw*Bs /2000.&gt; where the &lt;&gt; mean an 
        average over the previous 1 hour, Vsw is the solar wind speed, Dsw 
        is the solar wind density, Bs=|IMF Bz| when IMF Bz &lt; 0 and Bs=0 
        when IMF Bz &gt; 0.
      </li>
      <li>
        W1 - W6: see definition in (JGR-A, v.110(A3), 2005.) (PDF 1.2MB)
      </li>
      <li>
        AL: the auroral index
      </li>
    </ul>
  <h1 class="heading">Options:</h1>
    <ul>
      <li>
        1st element: 0 - don't compute L* or phi ;  1 - compute L*; 2- 
        compute phi
      </li>
      <li>
        2nd element: 0 - initialize IGRF field once per year (year.5); n - 
        n is the  frequency (in days) starting on January 1st of each year 
        (i.e. if options(2nd element)=15 then IGRF will be updated on the 
        following days of the year: 1, 15, 30, 45 ...)
      </li>
      <li>
        3rd element: resolution to compute L* (0 to 9) where 0 is the 
        recomended value to ensure a good ratio precision/computation time 
        (i.e. an error of ~2% at L=6). The higher the value the better will
        be the precision, the longer will be the computing time. Generally 
        there is not much improvement for values larger than 4. Note that 
        this parameter defines the integration step (theta) along the field
        line such as dtheta=(2pi)/(720*[options(3rd element)+1])
      </li>
      <li>
        4th element: resolution to compute L* (0 to 9). The higher the 
        value the better will be the precision, the longer will be the 
        computing time. It is recommended to use 0 (usually sufficient) 
        unless L* is not computed on a LEO orbit. For LEO orbit higher 
        values are recommended. Note that this parameter defines the 
        integration step (phi) along the drift shell such as 
        dphi=(2pi)/(25*[options(4th element)+1])
      </li>
      <li>
        5th element: allows to select an internal magnetic field model 
        (default is set to IGRF)
        <ul>
          <li>
            0 = IGRF
          </li>
          <li>
            1 = Eccentric tilted dipole
          </li>
          <li>
            2 = Jensen&amp;Cain 1960
          </li>
          <li>
            3 = GSFC 12/66 updated to 1970
          </li>
        </ul>
      </li>
    </ul>
  <h1 class="heading">Author:</h1>
    <p>Josef Koller, Los Alamos National Lab, jkoller@lanl.gov</p>
  <h1 class="heading">Version:</h1>
    <p>V1: 03-Feb-2010 (JK) V1.1: 22-Feb-2010: fixed Blocal and Bmirr bug 
    (JK) V1.2: 05-Mar-2010: ticktock, Coords support (JK)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== VARIABLES DETAILS ==================== -->
<a name="section-VariablesDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-VariablesDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="SYSAXES_TYPES"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">SYSAXES_TYPES</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
<code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">GDZ</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-op">: </code>None<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sph</code><code class="variable-quote">'</code><code class="variable-op">: </code>0<code class="variable-group">}</code><code class="variable-op">,</code>
 <code class="variable-quote">'</code><code class="variable-string">GEI</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-op">: </code>5<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sph</code><code class="variable-quote">'</code><code class="variable-op">: </code>None<code class="variable-group">}</code><code class="variable-op">,</code>
 <code class="variable-quote">'</code><code class="variable-string">GEO</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-op">: </code>1<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sph</code><code class="variable-quote">'</code><code class="variable-op">: </code>None<code class="variable-group">}</code><code class="variable-op">,</code>
 <code class="variable-quote">'</code><code class="variable-string">GSE</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-op">: </code>3<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sph</code><code class="variable-quote">'</code><code class="variable-op">: </code>None<code class="variable-group">}</code><code class="variable-op">,</code>
 <code class="variable-quote">'</code><code class="variable-string">GSM</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-op">: </code>2<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sph</code><code class="variable-quote">'</code><code class="variable-op">: </code>None<code class="variable-group">}</code><code class="variable-op">,</code>
 <code class="variable-quote">'</code><code class="variable-string">MAG</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-op">: </code>6<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sph</code><code class="variable-quote">'</code><code class="variable-op">: </code>None<code class="variable-group">}</code><code class="variable-op">,</code>
 <code class="variable-quote">'</code><code class="variable-string">RLL</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-op">: </code>None<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sph</code><code class="variable-quote">'</code><code class="variable-op">: </code>8<code class="variable-group">}</code><code class="variable-op">,</code>
 <code class="variable-quote">'</code><code class="variable-string">SM</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">car</code><code class="variable-quote">'</code><code class="variable-op">: </code>4<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sph</code><code class="variable-quote">'</code><code class="variable-op">: </code>None<code class="variable-group">}</code><code class="variable-op">,</code>
<code class="variable-ellipsis">...</code>
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="spacepy-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://spacepy.lanl.gov">SpacePy: Space Science Tools for Python</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Jan  5 17:53:40 2011
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
