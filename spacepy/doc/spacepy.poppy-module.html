<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>spacepy.poppy</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="spacepy-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >SpacePy: Space Science Tools for Python</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="spacepy-module.html">Package&nbsp;spacepy</a> ::
        Module&nbsp;poppy
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="spacepy.poppy-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module poppy</h1><p class="nomargin-top"><span class="codelink"><a href="spacepy.poppy-pysrc.html">source&nbsp;code</a></span></p>
<p>PoPPy -- Point Processes in Python.</p>
  <p>This module contains point process class types and a variety of 
  functions for association analysis. The routines given here grew from 
  work presented by Morley and Freeman (Geophysical Research Letters, 34, 
  L08104, doi:10.1029/ 2006GL028891, 2007), which were originally written 
  in IDL. This module is intended for application to discrete time series 
  of events to assess statistical association between the series and to 
  calculate confidence limits. Any mis-application or mis-interpretation by
  the user is the user's own fault.</p>
  <p>Each instance must be initialized with:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>obj = poppy.PPro(series1, series2)</pre>
  <p>To perform association analysis</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>obj.assoc(u=lags, h=halfwindow)</pre>
  <p>To plot</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>obj.aaplot()</pre>
  <p>--++-- By Steve Morley --++--</p>
  <p>smorley@lanl.gov/morley_steve@hotmail.com, Los Alamos National 
  Laboratory, ISR-1, PO Box 1663, Los Alamos, NM 87545</p>

<hr />
<div class="fields">      <p><strong>Author:</strong>
        Steve Morley (smorley@lanl.com/morley_steve@hotmail.com)
      </p>
</div><!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="spacepy.poppy.PPro-class.html" class="summary-name">PPro</a><br />
      PoPPy point process object
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="spacepy.poppy-module.html#boots_ci" class="summary-sig-name">boots_ci</a>(<span class="summary-sig-arg">data</span>,
        <span class="summary-sig-arg">n</span>,
        <span class="summary-sig-arg">inter</span>,
        <span class="summary-sig-arg">func</span>)</span><br />
      Construct bootstrap confidence interval - caution: slow!</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="spacepy.poppy-pysrc.html#boots_ci">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'spacepy'"><code class="variable-quote">'</code><code class="variable-string">spacepy</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="boots_ci"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">boots_ci</span>(<span class="sig-arg">data</span>,
        <span class="sig-arg">n</span>,
        <span class="sig-arg">inter</span>,
        <span class="sig-arg">func</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="spacepy.poppy-pysrc.html#boots_ci">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Construct bootstrap confidence interval - caution: slow!</p>
  <p>Input: n is number of surrogates; data is data array (1D); inter is 
  desired confidence interval (e.g. 95%); func is a user-defined function 
  (lambda)</p>
  <p>Example:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>data, n = numpy.random.lognormal(mean=5.1, sigma=0.3, size=3000), 4000.
<span class="py-prompt">&gt;&gt;&gt; </span>myfunc = <span class="py-keyword">lambda</span> x: numpy.median(x)
<span class="py-prompt">&gt;&gt;&gt; </span>ci_low, ci_high = poppy.boots_ci(data, n, 95, myfunc)
<span class="py-prompt">&gt;&gt;&gt; </span>ci_low, numpy.median(data), ci_high
<span class="py-output">(163.96354196633686, 165.2393331896551, 166.60491435416566) iter. 1</span>
<span class="py-output">... repeat</span>
<span class="py-output">(162.50379144492726, 164.15218265100233, 165.42840588032755) iter. 2</span></pre>
  <p>For comparison:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>data = numpy.random.lognormal(mean=5.1, sigma=0.3, size=90000)
<span class="py-prompt">&gt;&gt;&gt; </span>numpy.median(data)
<span class="py-output">163.83888237895815</span></pre>
  <p>Note that the true value of the desired quantity may lie outside the 
  95% confidence interval one time in 20 realizations. This occurred for 
  the first iteration - please feel free to play with this.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="spacepy-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >SpacePy: Space Science Tools for Python</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Thu May 27 15:56:04 2010
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
