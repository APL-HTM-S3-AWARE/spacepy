%
% API Documentation for SpacePy: Space Science Tools for Python
% Module spacepy.onerapy
%
% Generated by epydoc 3.0.1
% [Mon May 17 14:36:32 2010]
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                          Module Description                           %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}|(}
\section{Module spacepy.onerapy}

    \label{spacepy:onerapy}
module wrapper for onera\_desp\_lib Reference: D. Boscher1, S. Bourdarie1, 
P. O'Brien2, T. Guild2,(1 ONERA-DESP, Toulouse France; 2 Aerospace 
Corporation, Washington DC, USA), ONERA-DESP library V4.2, Toulouse-France,
2004-2008

\textbf{Version:} \$Revision: 1.1.1.1 $, \$Date: 2010/05/20 17:19:45 $



\textbf{Author:} Josef Koller, Los Alamos National Lab (jkoller@lanl.gov)




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               Functions                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \subsection{Functions}

    \label{spacepy:onerapy:get_Bfield}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.get\_Bfield \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{get\_Bfield}(\textit{ticktock}, \textit{spaco}, \textit{extMag}={\tt \texttt{'}\texttt{T01STORM}\texttt{'}}, \textit{options}={\tt \texttt{[}1\texttt{, }0\texttt{, }0\texttt{, }0\texttt{, }0\texttt{]}}, \textit{omnivals}={\tt None})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    call get\_bfield in onera\_desp lib and return a dictionary with the 
    B-field vector and strenght.

    (section) Input:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item ticktock (TickTock class) : containing time information

        \item spaco (Spaco class) : containing spatial information

        \item extMag (string) : optional; will choose the external magnetic 
          field model possible values ['0', 'MEAD', 'T87SHORT', 'T87LONG', 
          'T89', 'OPQUIET', 'OPDYN', 'T96', 'OSTA', 'T01QUIET', 'T01STORM',
          'T05', 'ALEX']

        \item options (optional list or array of integers length=5) : explained
          in Lstar

        \item omni values as dictionary (optional) : if not provided, will use 
          lookup table

        \item (see Lstar documentation for further explanation)

      \end{itemize}

    (section) Returns:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item results (dictionary) : containing keys: Bvec, and Blocal

      \end{itemize}

    (section) Example:

\begin{alltt}
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }t = TickTock([\pysrcstring{'2002-02-02T12:00:00'}, \pysrcstring{'2002-02-02T12:10:00'}], \pysrcstring{'ISO'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }y = SpaCo([[3,0,0],[2,0,0]], \pysrcstring{'GEO'}, \pysrcstring{'car'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }op.get\_Bfield(t,y)
\pysrcoutput{\{'Blocal': array([  945.99989101,  3381.71633205]),}
\pysrcoutput{        'Bvec': array([[  8.05001055e-01,  -1.54645026e+02,   9.33273841e+02],}
\pysrcoutput{        [  3.36352963e+02,  -5.33658140e+02,   3.32236076e+03]])\}}\end{alltt}
    (section) See Also:

      Lstar, find\_Bmirror, find\_magequator

    (section) Author:

      Josef Koller, Los Alamos National Lab, jkoller@lanl.gov

    (section) Version:

      V1: 05-Mar-2010 (JK)

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{spacepy:onerapy:find_Bmirror}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.find\_Bmirror \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{find\_Bmirror}(\textit{ticktock}, \textit{spaco}, \textit{alpha}, \textit{extMag}={\tt \texttt{'}\texttt{T01STORM}\texttt{'}}, \textit{options}={\tt \texttt{[}1\texttt{, }0\texttt{, }0\texttt{, }0\texttt{, }0\texttt{]}}, \textit{omnivals}={\tt None})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    call find\_mirror\_point from onera\_desp library and return a 
    dictionary with values for Blocal, Bmirr and the GEO (cartesian) 
    coordinates of the mirror point

    (section) Input:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item ticktock (TickTock class) : containing time information

        \item spaco (Spaco class) : containing spatial information

        \item alpha (list or ndarray) : containing the pitch angles

        \item extMag (string) : optional; will choose the external magnetic 
          field model possible values ['0', 'MEAD', 'T87SHORT', 'T87LONG', 
          'T89', 'OPQUIET', 'OPDYN', 'T96', 'OSTA', 'T01QUIET', 'T01STORM',
          'T05', 'ALEX']

        \item options (optional list or array of integers length=5) : explained
          in Lstar

        \item omni values as dictionary (optional) : if not provided, will use 
          lookup table

        \item (see Lstar documentation for further explanation)

      \end{itemize}

    (section) Returns:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item results (dictionary) : containing keys: Blocal, Bmirr, GEOcar

      \end{itemize}

    (section) Example:

\begin{alltt}
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }t = TickTock([\pysrcstring{'2002-02-02T12:00:00'}, \pysrcstring{'2002-02-02T12:10:00'}], \pysrcstring{'ISO'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }y = SpaCo([[3,0,0],[2,0,0]], \pysrcstring{'GEO'}, \pysrcstring{'car'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }op.find\_Bmirror(t,y,[90,80,60,10])
\pysrcoutput{\{'Blocal': array([ 0.,  0.]),}
\pysrcoutput{ 'Bmirr': array([ 0.,  0.]),}
\pysrcoutput{ 'GEOcar': SpaCo( [[ NaN  NaN  NaN]}
\pysrcoutput{ [ NaN  NaN  NaN]] ), dtype=GEO,car, units=['Re', 'Re', 'Re']\}}\end{alltt}
    (section) See Also:

      Lstar, get\_Bfield, find\_magequator

    (section) Author:

      Josef Koller, Los Alamos National Lab, jkoller@lanl.gov

    (section) Version:

      V1: 05-Mar-2010 (JK)

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{spacepy:onerapy:find_magequator}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.find\_magequator \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{find\_magequator}(\textit{ticktock}, \textit{spaco}, \textit{extMag}={\tt \texttt{'}\texttt{T01STORM}\texttt{'}}, \textit{options}={\tt \texttt{[}1\texttt{, }0\texttt{, }0\texttt{, }0\texttt{, }0\texttt{]}}, \textit{omnivals}={\tt None})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    call find\_magequator from onera\_desp library and return a dictionary 
    with values for Bmin and the GEO (cartesian) coordinates of the 
    magnetic equator

    (section) Input:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item ticktock (TickTock class) : containing time information

        \item spaco (Spaco class) : containing spatial information

        \item extMag (string) : optional; will choose the external magnetic 
          field model possible values ['0', 'MEAD', 'T87SHORT', 'T87LONG', 
          'T89', 'OPQUIET', 'OPDYN', 'T96', 'OSTA', 'T01QUIET', 'T01STORM',
          'T05', 'ALEX']

        \item options (optional list or array of integers length=5) : explained
          in Lstar

        \item omni values as dictionary (optional) : if not provided, will use 
          lookup table

        \item (see Lstar documentation for further explanation)

      \end{itemize}

    (section) Returns:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item results (dictionary) : containing keys: Bmin, SpaCo instance with
          GEO coordinates of the magnetic equator

      \end{itemize}

    (section) Example:

\begin{alltt}
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }t = TickTock([\pysrcstring{'2002-02-02T12:00:00'}, \pysrcstring{'2002-02-02T12:10:00'}], \pysrcstring{'ISO'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }y = SpaCo([[3,0,0],[2,0,0]], \pysrcstring{'GEO'}, \pysrcstring{'car'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }op.find\_magequator(t,y)
\pysrcoutput{\{'Bmin': array([  945.63652413,  3373.64496167]),}
\pysrcoutput{ 'GEOcar': SpaCo( [[ 2.99938371  0.00534151 -0.03213603]}
\pysrcoutput{ [ 2.00298822 -0.0073077   0.04584859]] ), dtype=GEO,car, units=['Re', 'Re', 'Re']\}}\end{alltt}
    (section) See Also:

      Lstar, get\_Bfield, find\_Bmirr

    (section) Author:

      Josef Koller, Los Alamos National Lab, jkoller@lanl.gov

    (section) Version:

      V1: 05-Mar-2010 (JK)

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{spacepy:onerapy:coord_trans}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.coord\_trans \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{coord\_trans}(\textit{spaco}, \textit{returntype}, \textit{returncarsph})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    thin layer to call coor\_trans1 from onera\_desp lib this will convert 
    between systems GDZ, GEO, GSM, GSE, SM, GEI, MAG, SPH, RLL

    (section) Input:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item spaco (SpaCo instance) : containing coordinate information, can 
          contain n points

        \item returntype (str) : describing system as GDZ, GEO, GSM, GSE, SM, 
          GEI, MAG, SPH, RLL

        \item returncarsph (str) : cartesian or spherical units 'car', 'sph'

      \end{itemize}

    (section) Returns:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item xout (ndarray) : values after transformation in (n,3) dimensions

      \end{itemize}

    (section) Example:

\begin{alltt}
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }coord = SpaCo([[3,0,0],[2,0,0]], \pysrcstring{'GEO'}, \pysrcstring{'car'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }coord.ticktock = TickTock([\pysrcstring{'2002-02-02T12:00:00'}, \pysrcstring{'2002-02-02T12:10:00'}], \pysrcstring{'ISO'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }coord\_trans(coord, \pysrcstring{'GSM'}, \pysrcstring{'car'})
\pysrcoutput{array([[ 2.8639301 , -0.01848784,  0.89306361],}
\pysrcoutput{[ 1.9124434 ,  0.07209424,  0.58082929]])}\end{alltt}
    (section) See Also:

      sph2car, car2sph

    (section) Author:

      Josef Koller, Los Alamos National Lab, jkoller@lanl.gov

    (section) Version:

      V1: 05-Mar-2010 (JK)

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{spacepy:onerapy:car2sph}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.car2sph \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{car2sph}(\textit{CARin})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    coordinate transformation from cartesian to spherical

    (section) Input:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item CARin (list or ndarray) : coordinate points in (n,3) shape with n
          coordinate points in units of [Re, Re, Re] = [x,y,z]

      \end{itemize}

    (section) Returns:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item results (ndarray) : values after conversion to spherical 
          coordinates in radius, latitude, longitude in units of [Re, deg, 
          deg]

      \end{itemize}

    (section) Example:

\begin{alltt}
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }sph2car([1,45,0])
\pysrcoutput{array([ 0.70710678,  0.        ,  0.70710678])}\end{alltt}
    (section) See Also:

      sph2car

    (section) Author:

      Josef Koller, Los Alamos National Lab, jkoller@lanl.gov

    (section) Version:

      V1: 05-Mar-2010 (JK)

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{spacepy:onerapy:sph2car}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.sph2car \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{sph2car}(\textit{SPHin})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    coordinate transformation from spherical to cartesian

    (section) Input:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item SPHin (list or ndarray) : coordinate points in (n,3) shape with n
          coordinate points in units of [Re, deg, deg] = [r, latitude, 
          longitude]

      \end{itemize}

    (section) Returns:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item results (ndarray) : values after conversion to cartesian 
          coordinates x,y,z

      \end{itemize}

    (section) Example:

\begin{alltt}
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }sph2car([1,45,45])
\pysrcoutput{array([ 0.5       ,  0.5       ,  0.70710678])}\end{alltt}
    (section) See Also:

      car2sph

    (section) Author:

      Josef Koller, Los Alamos National Lab, jkoller@lanl.gov

    (section) Version:

      V1: 05-Mar-2010 (JK)

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{spacepy:onerapy:get_sysaxes}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.get\_sysaxes \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{get\_sysaxes}(\textit{dtype}, \textit{carsph})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    will return the sysaxes according to the onera\_desp library

    (section) Input:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item dtype (str) : coordinate system, possible values: GDZ, GEO, GSM, 
          GSE, SM, GEI, MAG, SPH, RLL

        \item carsph (str) : cartesian or spherical, possible values: 'sph', 
          'car'

      \end{itemize}

    (section) Returns:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item sysaxes (int) : value after oner\_desp library from 0-8 (or None 
          if not available)

      \end{itemize}

    (section) Example:

\begin{alltt}
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }get\_sysaxes(\pysrcstring{'GSM'}, \pysrcstring{'car'})
\pysrcoutput{2}\end{alltt}
    (section) See Also:

      get\_dtype

    (section) Author:

      Josef Koller, Los Alamos National Lab, jkoller@lanl.gov Steve Morley,
      Los Alamos National Lab, smorley@lanl.gov

    (section) Version:

      V1: 05-Mar-2010 (JK) V2: 10-May-2010 (SM)

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{spacepy:onerapy:get_dtype}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.get\_dtype \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{get\_dtype}(\textit{sysaxes})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    will return the coordinate system type as string

    (section) Input:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item sysaxes (int) : number according to the onera\_desp\_lib, 
          possible values: 0-8

      \end{itemize}

    (section) Returns:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item dtype (str) : coordinate system GDZ, GEO, GSM, GSE, SM, GEI, MAG,
          SPH, RLL

        \item carsph (str) : cartesian or spherical 'car', 'sph'

      \end{itemize}

    (section) Example:

\begin{alltt}
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }get\_dtype(3)
\pysrcoutput{('GSE', 'car')}\end{alltt}
    (section) See Also:

      get\_sysaxes

    (section) Author:

      Josef Koller, Los Alamos National Lab, jkoller@lanl.gov

    (section) Version:

      V1: 05-Mar-2010 (JK)

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{spacepy:onerapy:get_Lstar}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.get\_Lstar \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{get\_Lstar}(\textit{ticktock}, \textit{spaco}, \textit{alpha}, \textit{extMag}={\tt \texttt{'}\texttt{T01STORM}\texttt{'}}, \textit{options}={\tt \texttt{[}1\texttt{, }0\texttt{, }0\texttt{, }0\texttt{, }0\texttt{]}}, \textit{omnivals}={\tt None})

    \vspace{-1.5ex}

    \rule{\textwidth}{0.5\fboxrule}
\setlength{\parskip}{2ex}
    This will call make\_lstar1 or make\_lstar\_shell\_splitting\_1 from 
    the onera library and will lookup omni values for given time if not 
    provided (optional). If pitch angles are provided, drift shell 
    splitting will be calculated and "Bmirr" will be returned. If they are 
    not provided, then no drift shell splitting is calculated and "Blocal" 
    is returned.

    (section) Input:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item ticktock (TickTock class) : containing time information

        \item spaco (Spaco class) : containing spatial information

        \item alpha (list or ndarray) : optional pitch angles in degrees; if 
          provided will calculate shell splitting; max 25 values

        \item extMag (string) : optional; will choose the external magnetic 
          field model possible values ['0', 'MEAD', 'T87SHORT', 'T87LONG', 
          'T89', 'OPQUIET', 'OPDYN', 'T96', 'OSTA', 'T01QUIET', 'T01STORM',
          'T05', 'ALEX']

        \item options (optional list or array of integers length=5) : explained
          below

        \item omni values as dictionary (optional) : if not provided, will use 
          lookup table

      \end{itemize}

    (section) Returns:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item results (dictionary) : containing keys: Lm, Lstar, Bmin, Blocal 
          (or Bmirr), Xj, MLT if pitch angles provided in "alpha" then 
          drift shells are calculated and "Bmirr" is returned if not 
          provided, then "Blocal" at spacecraft is returned.

      \end{itemize}

    (section) Example:

\begin{alltt}
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }t = TickTock([\pysrcstring{'2002-02-02T12:00:00'}, \pysrcstring{'2002-02-02T12:10:00'}], \pysrcstring{'ISO'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }y = SpaCo([[3,0,0],[2,0,0]], \pysrcstring{'GEO'}, \pysrcstring{'car'})
\pysrcprompt{{\textgreater}{\textgreater}{\textgreater} }spacepy.onerapy.Lstar(t,y)
\pysrcoutput{\{'Blocal': array([ 1020.40493286,  3446.08845227]),}
\pysrcoutput{    'Bmin': array([ 1019.98404311,  3437.63865243]),}
\pysrcoutput{    'Lm': array([ 3.08948304,  2.06022102]),}
\pysrcoutput{    'Lstar': array([ 2.97684043,  1.97868577]),}
\pysrcoutput{    'MLT': array([ 23.5728333 ,  23.57287944]),}
\pysrcoutput{    'Xj': array([ 0.00112884,  0.00286955])\}}\end{alltt}
    (section) External Magnetic Field:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item 0    : no external field

        \item MEAD  : Mead \& Fairfield [1975] (uses 
          0{\textless}=Kp{\textless}=9 - Valid for rGEO{\textless}=17. Re)

        \item T87SHORT: Tsyganenko short [1987] (uses 
          0{\textless}=Kp{\textless}=9 - Valid for rGEO{\textless}=30. Re)

        \item T87LONG : Tsyganenko long [1987] (uses 
          0{\textless}=Kp{\textless}=9 - Valid for rGEO{\textless}=70. Re)

        \item T89    : Tsyganenko [1989] (uses 0{\textless}=Kp{\textless}=9 - 
          Valid for rGEO{\textless}=70. Re)

        \item OPQUIET : Olson \& Pfitzer quiet [1977] (default - Valid for 
          rGEO{\textless}=15. Re)

        \item OPDYN   : Olson \& Pfitzer dynamic [1988] (uses 
          5.{\textless}=dens{\textless}=50., 
          300.{\textless}=velo{\textless}=500., 
          -100.{\textless}=Dst{\textless}=20. - Valid for 
          rGEO{\textless}=60. Re)

        \item T96    : Tsyganenko [1996] (uses -100.{\textless}=Dst 
          (nT){\textless}=20., 0.5{\textless}=Pdyn (nPa){\textless}10., 
          {\textbar}ByIMF{\textbar} (nT){\textless}1=0., 
          {\textbar}BzIMF{\textbar} (nT){\textless}=10. - Valid for 
          rGEO{\textless}=40. Re)

        \item OSTA  : Ostapenko \& Maltsev [1997] (uses dst,Pdyn,BzIMF, Kp) 
          T01QUIET: Tsyganenko [2002a,b] (uses -50.{\textless}Dst 
          (nT){\textless}20., 0.5{\textless}Pdyn (nPa){\textless}=5., 
          {\textbar}ByIMF{\textbar} (nT){\textless}=5., 
          {\textbar}BzIMF{\textbar} (nT){\textless}=5., 
          0.{\textless}=G1{\textless}=10., 0.{\textless}=G2{\textless}=10. 
          - Valid for xGSM{\textgreater}=-15. Re)

        \item T01STORM: Tsyganenko, Singer \& Kasper [2003] storm  (uses Dst, 
          Pdyn, ByIMF, BzIMF, G2, G3 - there is no upper or lower limit for
          those inputs - Valid for xGSM{\textgreater}=-15. Re)

        \item T05    : Tsyganenko \& Sitnov [2005] storm  (uses Dst, Pdyn, 
          ByIMF, BzIMF, W1, W2, W3, W4, W5, W6 - no upper or lower limit 
          for inputs - Valid for xGSM{\textgreater}=-15. Re)

      \end{itemize}

    (section) OMNI Values:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item Kp: value of Kp as in OMNI2 files but has to be double instead of
          integer type

        \item Dst: Dst index (nT)

        \item dens: Solar Wind density (cm-3)

        \item velo: Solar Wind velocity (km/s)

        \item Pdyn: Solar Wind dynamic pressure (nPa)

        \item ByIMF: GSM y component of IMF mag. field (nT)

        \item BzIMF: GSM z component of IMF mag. field (nT)

        \item G1:  G1={\textless} Vsw*(Bperp/40)2/(1+Bperp/40)*sin3(theta/2) 
          {\textgreater} where the {\textless}{\textgreater} mean an 
          average over the previous 1 hour, Vsw is the solar wind speed, 
          Bperp is the transverse IMF component (GSM) and theta it's clock 
          angle.

        \item G2: G2={\textless} a*Vsw*Bs {\textgreater} where the 
          {\textless}{\textgreater} mean an average over the previous 1 
          hour, Vsw is solar wind speed, Bs={\textbar}IMF Bz{\textbar} when
          IMF Bz {\textless} 0 and Bs=0 when IMF Bz {\textgreater} 0, 
          a=0.005.

        \item G3:  G3={\textless} Vsw*Dsw*Bs /2000.{\textgreater} where the 
          {\textless}{\textgreater} mean an average over the previous 1 
          hour, Vsw is the solar wind speed, Dsw is the solar wind density,
          Bs={\textbar}IMF Bz{\textbar} when IMF Bz {\textless} 0 and Bs=0 
          when IMF Bz {\textgreater} 0.

        \item W1 - W6: see definition in (JGR-A, v.110(A3), 2005.) (PDF 1.2MB)

        \item AL: the auroral index

      \end{itemize}

    (section) Options:

      \begin{itemize}
      \setlength{\parskip}{0.6ex}
        \item 1st element: 0 - don't compute L* or phi ;  1 - compute L*; 2- 
          compute phi

        \item 2nd element: 0 - initialize IGRF field once per year (year.5); n 
          - n is the  frequency (in days) starting on January 1st of each 
          year (i.e. if options(2nd element)=15 then IGRF will be updated 
          on the following days of the year: 1, 15, 30, 45 ...)

        \item 3rd element: resolution to compute L* (0 to 9) where 0 is the 
          recomended value to ensure a good ratio precision/computation 
          time (i.e. an error of {\textasciitilde}2\% at L=6). The higher 
          the value the better will be the precision, the longer will be 
          the computing time. Generally there is not much improvement for 
          values larger than 4. Note that this parameter defines the 
          integration step (theta) along the field line such as 
          dtheta=(2pi)/(720*[options(3rd element)+1])

        \item 4th element: resolution to compute L* (0 to 9). The higher the 
          value the better will be the precision, the longer will be the 
          computing time. It is recommended to use 0 (usually sufficient) 
          unless L* is not computed on a LEO orbit. For LEO orbit higher 
          values are recommended. Note that this parameter defines the 
          integration step (phi) along the drift shell such as 
          dphi=(2pi)/(25*[options(4th element)+1])

        \item 5th element: allows to select an internal magnetic field model 
          (default is set to IGRF)

          \begin{itemize}
          \setlength{\parskip}{0.6ex}
            \item 0 = IGRF

            \item 1 = Eccentric tilted dipole

            \item 2 = Jensen\&Cain 1960

            \item 3 = GSFC 12/66 updated to 1970

          \end{itemize}

      \end{itemize}

    (section) Author:

      Josef Koller, Los Alamos National Lab, jkoller@lanl.gov

    (section) Version:

      V1: 03-Feb-2010 (JK) V1.1: 22-Feb-2010: fixed Blocal and Bmirr bug 
      (JK) V1.2: 05-Mar-2010: ticktock, spaco support (JK)

\setlength{\parskip}{1ex}
    \end{boxedminipage}

    \label{spacepy:onerapy:prep_onera}
    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}!spacepy.onerapy.prep\_onera \textit{(function)}}

    \vspace{0.5ex}

\hspace{.8\funcindent}\begin{boxedminipage}{\funcwidth}

    \raggedright \textbf{prep\_onera}(\textit{ticktock}={\tt None}, \textit{spaco}={\tt None}, \textit{alpha}={\tt \texttt{[}\texttt{]}}, \textit{extMag}={\tt \texttt{'}\texttt{T01STORM}\texttt{'}}, \textit{options}={\tt \texttt{[}1\texttt{, }0\texttt{, }0\texttt{, }0\texttt{, }0\texttt{]}}, \textit{omnivals}={\tt None})

\setlength{\parskip}{2ex}
\setlength{\parskip}{1ex}
    \end{boxedminipage}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               Variables                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \subsection{Variables}

    \vspace{-1cm}
\hspace{\varindent}\begin{longtable}{|p{\varnamewidth}|p{\vardescrwidth}|l}
\cline{1-2}
\cline{1-2} \centering \textbf{Name} & \centering \textbf{Description}& \\
\cline{1-2}
\endhead\cline{1-2}\multicolumn{3}{r}{\small\textit{continued on next page}}\\\endfoot\cline{1-2}
\endlastfoot\raggedright \_\-\_\-l\-o\-g\-\_\-\_\- & \raggedright \textbf{Value:} 
{\tt \texttt{'}\texttt{{\textbackslash}n\$Log: spacepy.onerapy-module.tex,v $
{\tt \texttt{'}\texttt{{\textbackslash}n\Revision 1.1.1.1  2010/05/20 17:19:45  smorley
{\tt \texttt{'}\texttt{{\textbackslash}n\Pre-release repo import for SpacePy
{\tt \texttt{'}\texttt{{\textbackslash}n\
{\tt \texttt{'}\texttt{{\textbackslash}n\Revision 1.1  2010/05/19 22:30:51  smorley
{\tt \texttt{'}\texttt{{\textbackslash}n\Regenerated documentation
{\tt \texttt{'}\texttt{{\textbackslash}n\{\textbackslash}nRevision 1.5  2010/05/17 17:38:5}\texttt{...}}&\\
\cline{1-2}
\raggedright \_\-\_\-p\-a\-c\-k\-a\-g\-e\-\_\-\_\- & \raggedright \textbf{Value:} 
{\tt \texttt{'}\texttt{spacepy}\texttt{'}}&\\
\cline{1-2}
\end{longtable}

    \index{spacepy \textit{(package)}!spacepy.onerapy \textit{(module)}|)}
